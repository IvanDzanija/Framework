\doxysection{maf\+::math Namespace Reference}
\hypertarget{namespacemaf_1_1math}{}\label{namespacemaf_1_1math}\index{maf::math@{maf::math}}
\doxysubsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}
\item 
class \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}
\begin{DoxyCompactList}\small\item\em A general-\/purpose, row-\/major, dense matrix class. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename T$>$ }\\\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \mbox{\hyperlink{namespacemaf_1_1math_a45286ae95d74e7a19ecf706538b151e7}{cholesky}} (const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \&matrix)
\begin{DoxyCompactList}\small\item\em Computes the Cholesky decomposition of a symmetric positive definite matrix. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T, typename U$>$ }\\constexpr bool \mbox{\hyperlink{namespacemaf_1_1math_a3d4733be1cd68ede07a9c2de6728b2d7}{loosely\+\_\+equal}} (const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \&first, const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ U $>$ \&second, double eps=1e-\/6)
\begin{DoxyCompactList}\small\item\em Checks if two matrices are element-\/wise equal within a tolerance. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T$>$ }\\\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \mbox{\hyperlink{namespacemaf_1_1math_a4d61c9a4c0434a2e01652894564f7ebb}{identity\+\_\+matrix}} (size\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Creates a new identity matrix of a given size. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename U$>$ }\\\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ U $>$ \mbox{\hyperlink{namespacemaf_1_1math_a44a90b54cc59e94a6502aa223b893215}{ones}} (size\+\_\+t rows, size\+\_\+t cols)
\begin{DoxyCompactList}\small\item\em Creates a new matrix filled with ones. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T$>$ }\\\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \mbox{\hyperlink{namespacemaf_1_1math_a0fe2f174cf146553516e15feb16733c5}{make\+\_\+permutation\+\_\+matrix}} (const std\+::vector$<$ \mbox{\hyperlink{_global_header_8hpp_a5522c54735d837fae7d6ba026b858441}{uint32}} $>$ \&perm)
\begin{DoxyCompactList}\small\item\em Creates a new permutation matrix from a permutation vector. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T$>$ }\\std\+::tuple$<$ std\+::vector$<$ \mbox{\hyperlink{_global_header_8hpp_a5522c54735d837fae7d6ba026b858441}{uint32}} $>$, \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$, \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ $>$ \mbox{\hyperlink{namespacemaf_1_1math_ac44a6962e2d09c20d929223448b4421c}{plu}} (const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \&matrix)
\begin{DoxyCompactList}\small\item\em Performs a blocked PLU decomposition on a square matrix. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T, typename U$>$ }\\auto \mbox{\hyperlink{namespacemaf_1_1math_a92c661d711efb613ef38ff09aad60a11}{operator+}} (const U \&scalar, const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&vec)
\item 
{\footnotesize template$<$typename T, typename U$>$ }\\auto \mbox{\hyperlink{namespacemaf_1_1math_a487f2b044c2c1f92018a75592289c035}{operator-\/}} (const U \&scalar, const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&vec)
\item 
{\footnotesize template$<$typename T, typename U$>$ }\\auto \mbox{\hyperlink{namespacemaf_1_1math_a2eb500c1b4cfbb3169604245422bd93e}{correlated\+\_\+shocks}} (const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ U $>$ \&L, const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&Z)
\item 
{\footnotesize template$<$typename T$>$ }\\double \mbox{\hyperlink{namespacemaf_1_1math_a3ecc6092e067ec17d8e9ed22a66f5deb}{mean}} (const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&data)
\begin{DoxyCompactList}\small\item\em Calculates the unbiased estimator of expected value aka mean. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T$>$ }\\double \mbox{\hyperlink{namespacemaf_1_1math_a66ab6cca490d0bd2354b736a13658711}{covariance}} (const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&x, const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&y)
\begin{DoxyCompactList}\small\item\em Calculates the unbiased estimator of sample covariance. \end{DoxyCompactList}\item 
{\footnotesize template$<$typename T$>$ }\\double \mbox{\hyperlink{namespacemaf_1_1math_a0bdeb6320da66ec8fa672a071ac38cca}{covariance}} (const std\+::vector$<$ T $>$ \&x, T mean\+\_\+x, const std\+::vector$<$ T $>$ \&y, T mean\+\_\+y)
\end{DoxyCompactItemize}


\label{doc-func-members}
\Hypertarget{namespacemaf_1_1math_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{namespacemaf_1_1math_a45286ae95d74e7a19ecf706538b151e7}\index{maf::math@{maf::math}!cholesky@{cholesky}}
\index{cholesky@{cholesky}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{cholesky()}{cholesky()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a45286ae95d74e7a19ecf706538b151e7} 
template$<$typename T$>$ \\
\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ maf\+::math\+::cholesky (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \&}]{matrix}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [nodiscard]}}



Computes the Cholesky decomposition of a symmetric positive definite matrix. 

This function computes the Cholesky factorization (A = LL\texorpdfstring{$^\wedge$}{\string^}T) for a given square, symmetric, positive definite matrix A, where\+:
\begin{DoxyItemize}
\item A is the input matrix.
\item L is a lower triangular matrix with positive diagonal entries.
\item L\texorpdfstring{$^\wedge$}{\string^}T is the conjugate transpose of L (which is just the transpose for real matrices).
\end{DoxyItemize}

A matrix has a Cholesky decomposition if and only if it is symmetric and positive definite. This function checks for symmetry first. It then detects non-\/positive-\/definiteness during the computation.

The decomposition is computed using a blocked Cholesky-\/\+Crout algorithm for improved cache performance. The implementation is parallelized using Open\+MP (for both multi-\/threading and SIMD vectorization) for further performance gains.

More information\+: \href{https://en.wikipedia.org/wiki/Cholesky_decomposition}{\texttt{https\+://en.\+wikipedia.\+org/wiki/\+Cholesky\+\_\+decomposition}}


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & The numeric type of the matrix elements (e.\+g., float, double). \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em matrix} & The const reference to the square, symmetric, positive definite input matrix (A) to decompose. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
(\doxylink{classmaf_1_1math_1_1_matrix}{Matrix$<$\+T$>$}) The lower triangular matrix (L).
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em std\+::invalid\+\_\+argument} & if the input matrix is not symmetric, or if it is not positive definite (detected during factorization).\\
\hline
\end{DoxyExceptions}
\begin{DoxyVersion}{Version}
1.\+0 (Blocked \& Parallelized) 
\end{DoxyVersion}
\begin{DoxySince}{Since}
2025 
\end{DoxySince}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d02/namespacemaf_1_1math_a45286ae95d74e7a19ecf706538b151e7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{d4/d02/namespacemaf_1_1math_a45286ae95d74e7a19ecf706538b151e7_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a2eb500c1b4cfbb3169604245422bd93e}\index{maf::math@{maf::math}!correlated\_shocks@{correlated\_shocks}}
\index{correlated\_shocks@{correlated\_shocks}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{correlated\_shocks()}{correlated\_shocks()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a2eb500c1b4cfbb3169604245422bd93e} 
template$<$typename T, typename U$>$ \\
auto maf\+::math\+::correlated\+\_\+shocks (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ U $>$ \&}]{L}{, }\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&}]{Z}{}\end{DoxyParamCaption})}

Creates a vector of correlated random variables from a vector of independant random variables based on Cholesky decomposition of covariance matrix. \href{https://en.wikipedia.org/wiki/Cholesky_decomposition\#Monte_Carlo_simulation}{\texttt{https\+://en.\+wikipedia.\+org/wiki/\+Cholesky\+\_\+decomposition\#\+Monte\+\_\+\+Carlo\+\_\+simulation}} \begin{DoxyReturn}{Returns}
\doxylink{classmaf_1_1math_1_1_vector}{Vector} of common promoted type. 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=344pt]{d4/d02/namespacemaf_1_1math_a2eb500c1b4cfbb3169604245422bd93e_cgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a0bdeb6320da66ec8fa672a071ac38cca}\index{maf::math@{maf::math}!covariance@{covariance}}
\index{covariance@{covariance}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{covariance()}{covariance()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a0bdeb6320da66ec8fa672a071ac38cca} 
template$<$typename T$>$ \\
double maf\+::math\+::covariance (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ T $>$ \&}]{x}{, }\item[{T}]{mean\+\_\+x}{, }\item[{const std\+::vector$<$ T $>$ \&}]{y}{, }\item[{T}]{mean\+\_\+y}{}\end{DoxyParamCaption})}

Calculates the unbiased estimar of sample variance. Use if means are already cached. \Hypertarget{namespacemaf_1_1math_a66ab6cca490d0bd2354b736a13658711}\index{maf::math@{maf::math}!covariance@{covariance}}
\index{covariance@{covariance}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{covariance()}{covariance()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a66ab6cca490d0bd2354b736a13658711} 
template$<$typename T$>$ \\
double maf\+::math\+::covariance (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&}]{x}{, }\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&}]{y}{}\end{DoxyParamCaption})}



Calculates the unbiased estimator of sample covariance. 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d02/namespacemaf_1_1math_a66ab6cca490d0bd2354b736a13658711_cgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a4d61c9a4c0434a2e01652894564f7ebb}\index{maf::math@{maf::math}!identity\_matrix@{identity\_matrix}}
\index{identity\_matrix@{identity\_matrix}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{identity\_matrix()}{identity\_matrix()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a4d61c9a4c0434a2e01652894564f7ebb} 
template$<$typename T$>$ \\
\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ maf\+::math\+::identity\+\_\+matrix (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{size}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [nodiscard]}}



Creates a new identity matrix of a given size. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & The numeric type of the matrix. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em size} & The width and height of the square matrix. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An identity \doxylink{classmaf_1_1math_1_1_matrix}{Matrix$<$\+T$>$} of size (size x size). 
\end{DoxyReturn}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d02/namespacemaf_1_1math_a4d61c9a4c0434a2e01652894564f7ebb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d02/namespacemaf_1_1math_a4d61c9a4c0434a2e01652894564f7ebb_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a3d4733be1cd68ede07a9c2de6728b2d7}\index{maf::math@{maf::math}!loosely\_equal@{loosely\_equal}}
\index{loosely\_equal@{loosely\_equal}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{loosely\_equal()}{loosely\_equal()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a3d4733be1cd68ede07a9c2de6728b2d7} 
template$<$typename T, typename U$>$ \\
bool maf\+::math\+::loosely\+\_\+equal (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \&}]{first}{, }\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ U $>$ \&}]{second}{, }\item[{double}]{eps}{ = {\ttfamily 1e-\/6}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [nodiscard]}, {\ttfamily [constexpr]}}



Checks if two matrices are element-\/wise equal within a tolerance. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & Numeric type of the first matrix. \\
\hline
{\em U} & Numeric type of the second matrix. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em eps} & The absolute tolerance for equality. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if dimensions match and all elements are "{}close"{}. 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{d4/d02/namespacemaf_1_1math_a3d4733be1cd68ede07a9c2de6728b2d7_cgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a0fe2f174cf146553516e15feb16733c5}\index{maf::math@{maf::math}!make\_permutation\_matrix@{make\_permutation\_matrix}}
\index{make\_permutation\_matrix@{make\_permutation\_matrix}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{make\_permutation\_matrix()}{make\_permutation\_matrix()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a0fe2f174cf146553516e15feb16733c5} 
template$<$typename T$>$ \\
\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ maf\+::math\+::make\+\_\+permutation\+\_\+matrix (\begin{DoxyParamCaption}\item[{const std\+::vector$<$ \mbox{\hyperlink{_global_header_8hpp_a5522c54735d837fae7d6ba026b858441}{uint32}} $>$ \&}]{perm}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [nodiscard]}}



Creates a new permutation matrix from a permutation vector. 


\begin{DoxyTemplParams}{Template Parameters}
{\em T} & The numeric type of the matrix. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em perm} & A vector where {\ttfamily perm\mbox{[}i\mbox{]} = j} means row {\ttfamily i} maps to column {\ttfamily j}. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A sparse permutation \doxylink{classmaf_1_1math_1_1_matrix}{Matrix$<$\+T$>$}. 
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d02/namespacemaf_1_1math_a0fe2f174cf146553516e15feb16733c5_cgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a3ecc6092e067ec17d8e9ed22a66f5deb}\index{maf::math@{maf::math}!mean@{mean}}
\index{mean@{mean}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{mean()}{mean()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a3ecc6092e067ec17d8e9ed22a66f5deb} 
template$<$typename T$>$ \\
double maf\+::math\+::mean (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&}]{data}{}\end{DoxyParamCaption})}



Calculates the unbiased estimator of expected value aka mean. 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{d4/d02/namespacemaf_1_1math_a3ecc6092e067ec17d8e9ed22a66f5deb_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=320pt]{d4/d02/namespacemaf_1_1math_a3ecc6092e067ec17d8e9ed22a66f5deb_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a44a90b54cc59e94a6502aa223b893215}\index{maf::math@{maf::math}!ones@{ones}}
\index{ones@{ones}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{ones()}{ones()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a44a90b54cc59e94a6502aa223b893215} 
template$<$typename U$>$ \\
\mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ U $>$ maf\+::math\+::ones (\begin{DoxyParamCaption}\item[{size\+\_\+t}]{rows}{, }\item[{size\+\_\+t}]{cols}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [nodiscard]}}



Creates a new matrix filled with ones. 


\begin{DoxyTemplParams}{Template Parameters}
{\em U} & The numeric type of the matrix. \\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em rows} & Number of rows. \\
\hline
{\em cols} & Number of columns. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A \doxylink{classmaf_1_1math_1_1_matrix}{Matrix}\uline{ of size (rows x cols) filled with U(1). }
\end{DoxyReturn}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{d4/d02/namespacemaf_1_1math_a44a90b54cc59e94a6502aa223b893215_cgraph}
\end{center}
\end{figure}
\Hypertarget{namespacemaf_1_1math_a92c661d711efb613ef38ff09aad60a11}\index{maf::math@{maf::math}!operator+@{operator+}}
\index{operator+@{operator+}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{operator+()}{operator+()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a92c661d711efb613ef38ff09aad60a11} 
template$<$typename T, typename U$>$ \\
auto maf\+::math\+::operator+ (\begin{DoxyParamCaption}\item[{const U \&}]{scalar}{, }\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&}]{vec}{}\end{DoxyParamCaption})}

It\textquotesingle{}s recommended to use \doxylink{classmaf_1_1math_1_1_vector}{Vector} + Scalar instead. \begin{DoxyReturn}{Returns}
\doxylink{classmaf_1_1math_1_1_vector}{Vector} of common promoted type. 
\end{DoxyReturn}
\Hypertarget{namespacemaf_1_1math_a487f2b044c2c1f92018a75592289c035}\index{maf::math@{maf::math}!operator-\/@{operator-\/}}
\index{operator-\/@{operator-\/}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{operator-\/()}{operator-()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_a487f2b044c2c1f92018a75592289c035} 
template$<$typename T, typename U$>$ \\
auto maf\+::math\+::operator-\/ (\begin{DoxyParamCaption}\item[{const U \&}]{scalar}{, }\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_vector}{Vector}}$<$ T $>$ \&}]{vec}{}\end{DoxyParamCaption})}

Subtract each element of vector from a scalar. \begin{DoxyReturn}{Returns}
\doxylink{classmaf_1_1math_1_1_vector}{Vector} of common promoted type. 
\end{DoxyReturn}
\Hypertarget{namespacemaf_1_1math_ac44a6962e2d09c20d929223448b4421c}\index{maf::math@{maf::math}!plu@{plu}}
\index{plu@{plu}!maf::math@{maf::math}}
\doxysubsubsection{\texorpdfstring{plu()}{plu()}}
{\footnotesize\ttfamily \label{namespacemaf_1_1math_ac44a6962e2d09c20d929223448b4421c} 
template$<$typename T$>$ \\
std\+::tuple$<$ std\+::vector$<$ \mbox{\hyperlink{_global_header_8hpp_a5522c54735d837fae7d6ba026b858441}{uint32}} $>$, \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$, \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ $>$ maf\+::math\+::plu (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{classmaf_1_1math_1_1_matrix}{Matrix}}$<$ T $>$ \&}]{matrix}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [nodiscard]}}



Performs a blocked PLU decomposition on a square matrix. 

This function computes the PLU factorization (PA = LU) for a given square matrix A, where\+:
\begin{DoxyItemize}
\item P is a permutation matrix (represented by a vector)
\item L is a unit lower triangular matrix
\item U is an upper triangular matrix
\end{DoxyItemize}

The decomposition is computed using a right-\/looking blocked algorithm for improved cache performance. It employs partial pivoting (row swapping) to ensure numerical stability. The implementation is parallelized using Open\+MP for further performance gains on multi-\/core systems.

More information\+: \href{https://en.wikipedia.org/wiki/LU_decomposition\#LU_factorization_with_partial_pivoting}{\texttt{https\+://en.\+wikipedia.\+org/wiki/\+LU\+\_\+decomposition\#\+LU\+\_\+factorization\+\_\+with\+\_\+partial\+\_\+pivoting}}


\begin{DoxyParams}{Parameters}
{\em matrix} & The const reference to the square input matrix (A) to decompose. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
A std\+::tuple containing\+:
\begin{DoxyEnumerate}
\item (std\+::vector$<$uint32$>$) The final permutaion of rows.
\item (\doxylink{classmaf_1_1math_1_1_matrix}{Matrix$<$\+T$>$}) The unit lower triangular matrix (L).
\item (\doxylink{classmaf_1_1math_1_1_matrix}{Matrix$<$\+T$>$}) The upper triangular matrix (U).
\end{DoxyEnumerate}
\end{DoxyReturn}

\begin{DoxyExceptions}{Exceptions}
{\em std\+::invalid\+\_\+argument} & if the input matrix is not square.\\
\hline
\end{DoxyExceptions}
\begin{DoxyVersion}{Version}
1.\+0 (Blocked \& Parallelized) 
\end{DoxyVersion}
\begin{DoxySince}{Since}
2025 
\end{DoxySince}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d02/namespacemaf_1_1math_ac44a6962e2d09c20d929223448b4421c_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=294pt]{d4/d02/namespacemaf_1_1math_ac44a6962e2d09c20d929223448b4421c_icgraph}
\end{center}
\end{figure}
