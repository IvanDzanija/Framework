name: MafLib Tests
on:
Â  Â  push:
Â  Â  Â  Â  branches: [main]
Â  Â  pull_request:
Â  Â  Â  Â  branches: [main]

jobs:
Â  Â  build-and-test:
Â  Â  Â  Â  strategy:
Â  Â  Â  Â  Â  Â  matrix:
Â  Â  Â  Â  Â  Â  Â  Â  os: [ubuntu-latest, macos-latest]
Â  Â  Â  Â  runs-on: ${{ matrix.os }}

Â  Â  Â  Â  steps:
Â  Â  Â  Â  Â  Â  - name: Checkout repository
Â  Â  Â  Â  Â  Â  Â  uses: actions/checkout@v4

Â  Â  Â  Â  Â  Â  # Linux setup
Â  Â  Â  Â  Â  Â  - name: Install dependencies (Linux)
Â  Â  Â  Â  Â  Â  Â  if: runner.os == 'Linux'
Â  Â  Â  Â  Â  Â  Â  run: |
Â  Â  Â  Â  Â  Â  Â  Â  Â  sudo apt-get update
Â  Â  Â  Â  Â  Â  Â  Â  Â  sudo apt-get install -y clang ninja-build cmake libomp-dev

Â  Â  Â  Â  Â  Â  # macOS setup
Â  Â  Â  Â  Â  Â  - name: Install dependencies (macOS)
Â  Â  Â  Â  Â  Â  Â  if: runner.os == 'macOS'
Â  Â  Â  Â  Â  Â  Â  run: |
Â  Â  Â  Â  Â  Â  Â  Â  Â  brew update
Â  Â  Â  Â  Â  Â  Â  Â  Â  brew install cmake ninja llvm libomp
Â  Â  Â  Â  Â  Â  Â  Â  Â  echo "Adding Apple Clang to PATH"
Â  Â  Â  Â  Â  Â  Â  Â  Â  echo "$(brew --prefix llvm)/bin" >> $GITHUB_PATH

Â  Â  Â  Â  Â  Â  # Configure (CMake preset)
Â  Â  Â  Â  Â  Â  - name: Configure (clang-debug preset)
Â  Â  Â  Â  Â  Â  Â  run: cmake --preset clang-debug

Â  Â  Â  Â  Â  Â  # âš™ï¸ Build
Â  Â  Â  Â  Â  Â  - name: Build
Â  Â  Â  Â  Â  Â  Â  run: cmake --build --preset clang-debug --parallel

Â  Â  Â  Â  Â  Â  # ğŸ§ª Run tests
Â  Â  Â  Â  Â  Â  - name: Run tests
Â  Â  Â  Â  Â  Â  Â  run: ctest --preset clang-debug --output-on-failure
 adjust this but keep linux and macOS exactly the same
